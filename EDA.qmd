---
title: "EDA"
format: html
editor: visual
---

# Exploring the Data

## Introduction

I will be exploring the Diabetes Health Indicators Dataset. The response variable of interest is **Diabetes_binary**, which tells us if an individual has no diabetes or not. The variables I would like to explore for this project are:

-   **HighBP** Whether or not they have high blood pressure.
-   **HighChol** Whether or not they have high cholesterol.
-   **BMI**
-   **Age**
-   **GenHlth** Self reported health score with 1 being excellent 5 being poor.
-   **Sex**
-   **Smoker** Whether or not they smoked at least 100 cigarettes in their life.
-   **HvyAlcoholConsump** Adult men having more than 14 drinks per week and adult women having more than 7 drinks per week.

```{r}
# packages needed
library("tidyverse")
```

Reading in the data involves mutating variables that are coded as numbers and turning them into factors with the appropriate labels. Note I had to reference the codebook for the data to find the levels for a few of these variables.

```{r}
# read in data
db_data <- read_csv("diabetes_binary_health_indicators_BRFSS2015.csv") |>
  mutate(
    Diabetes_binary = factor(Diabetes_binary,
                          levels = c(0,1),
                          labels = c("No diabetes", "Diabetes")),
    
    HighBP = factor(HighBP,
                    levels = c(0,1),
                    labels = c("No high BP", "High BP")),
    
    HighChol = factor(HighChol,
                      levels = c(0,1),
                      labels = c("No high cholesterol", "High cholesterol")),
    
    CholCheck = factor(CholCheck,
                       levels = c(0,1),
                       labels = c("No cholesterol check", "Checked cholesterol")),
    
    Smoker = factor(Smoker,
                    levels = c(0,1),
                    labels = c("Non-smoker", "Smoker")),
    
    Stroke = factor(Stroke,
                    levels = c(0,1),
                    labels = c("No stroke", "Stroke")),
    
    HeartDiseaseorAttack = factor(HeartDiseaseorAttack,
                                  levels = c(0,1),
                                  labels = c("No CHD/MI", "CHD or MI")),
    
    PhysActivity = factor(PhysActivity,
                          levels = c(0,1),
                          labels = c("No physical activity", "Physically active")),
    
    Fruits = factor(Fruits,
                    levels = c(0,1),
                    labels = c("No fruit consumed", "Fruit consumed")),
    
    Veggies = factor(Veggies, 
                     levels = c(0,1),
                     labels = c("No veggies consumed", "Veggies consumed")),

    HvyAlcoholConsump = factor(HvyAlcoholConsump,
                               levels = c(0,1),
                               labels = c("Not heavy drinker", "Heavy drinker")),

    AnyHealthcare = factor(AnyHealthcare, 
                           levels = c(0,1),
                           labels = c("No healthcare", "Has healthcare")),

    NoDocbcCost = factor(NoDocbcCost, 
                         levels = c(0,1),
                         labels = c("Did not avoid care due to cost", "Avoided care due to cost")),

    DiffWalk = factor(DiffWalk, 
                      levels = c(0,1),
                      labels = c("No difficulty walking", "Difficulty walking")),

    Sex = factor(Sex, 
                 levels = c(0,1),
                 labels = c("Female", "Male")),

    GenHlth = factor(GenHlth, 
                     levels = c(1,2,3,4,5),
                     labels = c("Excellent", "Very good", "Good", "Fair", "Poor"),
                     ordered = TRUE),

    Age = factor(Age, 
                 levels = 1:13, 
                 labels = c("18-24", "25-29", "30-34", "35-39", "40-44", "45-49",
                            "50-54", "55-59", "60-64", "65-69", "70-74", "75-79", "80+"),
                 ordered = TRUE),

    Education = factor(Education, 
                       levels = 1:6, 
                       labels = c("No school", "Grades 1-8", "Grades 9-11","High school graduate",
                                  "Some collegel","College graduate"), 
                       ordered = TRUE),

    Income = factor(Income, 
                    levels = 1:8, 
                    labels = c("<10k", "<15k", "<20k", "<25k","<35k", "<50k","<75k","75k+"),
                    ordered = TRUE)

  )

# validate our data read in as desired
glimpse(db_data)

# check for missing values
colSums(is.na(db_data))

```

The data looks like it read in appropriately, I checked for missing values so we could account for them in our EDA where needed, fortunately it seems we do not have any.

We will start by doing some summary statistics on our only numeric variable, BMI.

```{r}
# numeric summary BMI
BMI_sum <- db_data |>
  summarize(
   meanBMI = mean(BMI),
   sdBMI = sd(BMI)
  )
print(BMI_sum)

```

We see the average BMI is 28.38 which is considered 'overweight' according to outside resources I found online.

What would happen if we summarize by our response variable, does weight vary with diabetes status?

```{r}
# numeric summary BMI by Diabetes_binary
BMI_sum <- db_data |>
  group_by(Diabetes_binary)|>
  summarize(
   meanBMI = mean(BMI),
   sdBMI = sd(BMI)
  )
print(BMI_sum)

```

We see those who have no diabetes are slightly lower than the overall average at 27.81. Those who have diabetes are slightly higher at 31.94. I want to create a histogram looking into the distribution of BMI by diabetes status, I will also facet by sex to see if that impacts our results.

```{r}
# Histogram BMI broke down by sex and diabetes_binary
ggplot(db_data, aes(x = BMI, fill=Diabetes_binary)) +
  facet_wrap(~Sex)+
  geom_histogram() +
  scale_fill_manual( name = "Diabetes Status",
                     values = c("No diabetes" = "#4ca0cb",  
                                "Diabetes"     = "#ee5b47")) +
  labs(title = "BMI Distribution", x = "BMI", y = "Count")
```

Here we see that the distribution of BMI by diabetes status is roughly the same for both sexes. We also observe that both those with and without diabetes seem to have a right skewed BMI. This may indicate sex is not a useful predictor of diabetes.

What if we broke this down by age group? We can create another histogram looking into the distribution of BMI by diabetes status but facet by age instead.

```{r}
# Histogram BMI broke down by age and diabetes_binary
ggplot(db_data, aes(x = BMI, fill=Diabetes_binary)) +
  facet_wrap(~Age)+
  geom_histogram() +
  scale_fill_manual( name = "Diabetes Status",
                     values = c("No diabetes" = "#4ca0cb",  
                                "Diabetes"     = "#ee5b47")) +
  labs(title = "BMI Distribution", x = "BMI", y = "Count")
```

We see younger people tend to not have diabetes, while older individuals do. The distribution of BMI still looks to similar between age groups and diabetes status, at the very least no distributions stick out to us.

Thinking about overall health lets now look at the contingency table for self reported general health scores.

```{r}
# contingency table GenHlth
n_health <- table(db_data$GenHlth)
n_health
```

Most people reported very good, while the least people reported poor.

How does this change when we break it up by diabetes status?

```{r}
# contingency table GenHlth by Diabetes_binary
n_health_db <- table(db_data$GenHlth,db_data$Diabetes_binary)
n_health_db
```

The overall pattern holds for those without diabetes but for those who do have it we see most people report good health, and the least people report excellent health. This indicates to us that those who have diabetes tend to feel worse about their general health.

```{r}
ggplot(db_data, aes(x = GenHlth, y = BMI)) +
  geom_boxplot(outlier.shape = NA) +
  labs(title = "BMI by General Health Rating")
```

People who smoke or consume lots of alcohol generally have poorer health, does this also apply to diabetes, lets check the contingency tables.

```{r}
# contingency table Smoker by Diabetes_binary
n_smoke_db <- table(db_data$Smoker,db_data$Diabetes_binary)
n_smoke_db

# contingency table GenHlth by Diabetes_binary
n_smoke_db <- table(db_data$HvyAlcoholConsump,db_data$Diabetes_binary)
n_smoke_db
```

Here we see that the heavy drinking group is smaller than the not heavy drinking group for both those with diabetes and those without. However, we we see that the smoker group is larger for the diabetes group. Lets try combining the two into a bar plot that displays proportion (to account for the fact the diabetes group has less observations) to see if this reveals any patterns.

```{r}
# Bar plot w/ diabetes_binary by HvyAlcoholConsump and smoker
ggplot(db_data, aes(x = Diabetes_binary, fill=HvyAlcoholConsump)) +
  facet_wrap(~Smoker)+
  geom_bar(position="fill") +
  scale_fill_manual( name = "Alcohol Consumption",
                     values = c("Not heavy drinker" = "#8da0cb",  
                                "Heavy drinker"     = "#fc8a47")) +
  labs(title = "Proportion of Diabetes", x = "Diabetes Status", y = "Proportion")
```

This communicates to us that people with diabetes do not have a higher proportion of heavy drinkers who smoke than those without diabetes. Maybe these two variables are not useful in predicting diabetes status.

From my knowledge, cholesterol and blood pressure are important indicators of diabetes. For that reason I will analyze them separately in bar plots that use proportion.

```{r}
#HighBP

# Proportion bar chart
ggplot(db_data, aes(x = HighBP, fill = Diabetes_binary)) +
  geom_bar(position = "fill") +
  scale_fill_manual( name = "Diabetes Status",
                     values = c("No diabetes" = "#4ca0cb",  
                                "Diabetes"     = "#ee5b47")) +
  labs(title = "High Blood Pressure by Diabetes", y = "Proportion")

#HighChol

# Proportion bar chart
ggplot(db_data, aes(x = HighChol, fill = Diabetes_binary)) +
  geom_bar(position = "fill") +
  scale_fill_manual( name = "Diabetes Status",
                     values = c("No diabetes" = "#4ca0cb",  
                                "Diabetes"     = "#ee5b47")) +
  labs(title = "High Cholesterol by Diabetes", y = "Proportion")

```

This theory holds we see a greater proportion of people with diabetes have high blood pressure, and have high cholesterol compared to those with diabetes with no high blood pressure and no high cholesterol respectively.

## Conclusion

I think **HighBP**, **HighChol**, **BMI**, **Age**, and **GenHlth** will be useful in predicting diabetes status while **Sex**, **Smoker**, and **HvyAlchoholConsump** will not. I will thus being using those five predictors in 
my modeling!


